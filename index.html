<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MinhKhoi's Commencement</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Playfair+Display:ital,wght@0,600;1,600&family=Great+Vibes&family=Courier+Prime&display=swap" rel="stylesheet">
    <style>
        :root {
            --palette-beige: #DCC6B3;        
            --palette-black: #0C0C0C;        
            --palette-white: #FFFFFF;        
            --palette-navy:  #0F1A30;        
            --palette-pink:  #F5D5D6;        
            --palette-grey:  #E5E5E7;        
            --palette-peri:  #9CA7C7;        
            
            --gold-text: #B88E2F; /* M√†u v√†ng ƒë·ªìng cho ch·ªØ */
            --bg-main: #FAF8F5;      
            --card-bg: #FFFFFF;      
            --text-main: #1E2C48;
            --text-sub:  #64748b;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-main);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        /* --- TASKBAR --- */
        .taskbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: var(--card-bg);
            padding: 12px 24px;
            border-radius: 16px;
            max-width: 1200px;
            margin: 0 auto 40px auto;
            box-shadow: 0 4px 20px rgba(30, 44, 72, 0.08); 
            flex-wrap: wrap;
            gap: 15px;
            border: 1px solid rgba(0,0,0,0.03);
        }

        .brand-section { display: flex; align-items: center; gap: 15px; }
        .logo-circle {
            width: 45px; height: 45px;
            background: linear-gradient(135deg, var(--palette-beige) 0%, var(--palette-pink) 100%);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 20px; color: var(--palette-navy);
        }

        .nav-links { display: flex; gap: 10px; flex-wrap: wrap; }
        .nav-item {
            text-decoration: none; color: var(--text-main);
            padding: 8px 16px; border-radius: 10px; font-size: 0.95rem;
            transition: 0.3s; font-weight: 500; cursor: pointer;
        }
        .nav-item.active { background-color: var(--palette-navy); color: var(--palette-white); }

        /* --- LAYOUT CHUNG --- */
        .content-section { max-width: 1000px; margin: 0 auto; display: none; }
        .content-section.active { display: block; animation: fadeIn 0.5s; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- THI·ªÜP M·ªúI (UPDATED STYLE) --- */
        .invitation-card {
            background: #F9F9F9; /* M√†u n·ªÅn h∆°i x√°m nh·∫π gi·ªëng gi·∫•y */
            max-width: 500px; 
            margin: 0 auto 30px auto;
            padding: 40px 30px; 
            text-align: center; 
            border-radius: 2px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05); 
            border: 1px solid #eee;
            position: relative;
            color: #333;
        }

        /* Ph·∫ßn ch·ªØ cong SVG */
        .curved-text-container {
            width: 100%;
            height: 100px;
            margin-bottom: -20px;
        }
        .curved-text-path {
            fill: transparent;
        }
        .curved-text {
            font-family: 'Courier Prime', monospace;
            font-size: 14px;
            letter-spacing: 2px;
            fill: #333;
            text-transform: uppercase;
            font-weight: 600;
        }

        /* Icon m≈© c·ª≠ nh√¢n */
        .grad-cap-icon {
            width: 120px;
            margin: 0 auto;
            display: block;
        }

        /* Ch·ªØ intro */
        .intro-text {
            font-family: 'Courier Prime', monospace;
            font-size: 1rem;
            color: #444;
            margin-top: 20px;
            letter-spacing: 0.5px;
        }

        /* T√™n Minh Kh√¥i */
        .script-name {
            font-family: 'Great Vibes', cursive;
            font-size: 4rem;
            color: var(--gold-text);
            margin: 0;
            line-height: 1.2;
            font-weight: 400;
        }

        /* Ti√™u ƒë·ªÅ s·ª± ki·ªán */
        .main-event-title {
            font-family: 'Courier Prime', monospace;
            text-transform: uppercase;
            letter-spacing: 4px;
            font-size: 1.4rem;
            color: #333;
            margin-top: 5px;
            font-weight: 600;
        }
        
        .sub-event-title {
            font-family: 'Courier Prime', monospace;
            text-transform: uppercase;
            letter-spacing: 6px;
            font-size: 1.4rem;
            color: #333;
            margin-bottom: 20px;
            font-weight: 600;
        }

        /* Grid th√¥ng tin (Ng√†y - ƒê·ªãa ƒëi·ªÉm - Gi·ªù) */
        .details-container {
            border-top: 1px solid #555;
            border-bottom: 1px solid #555;
            padding: 15px 0;
            margin: 25px 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .detail-col {
            padding: 0 15px;
            text-align: center;
        }

        .detail-col.center {
            border-left: 1px solid #555;
            border-right: 1px solid #555;
            flex: 1; /* C·ªôt gi·ªØa chi·∫øm ph·∫ßn th·ª´a */
        }

        .gold-label {
            color: var(--gold-text);
            font-weight: bold;
            font-size: 1.4rem;
            font-family: 'Courier Prime', monospace;
            display: block;
            line-height: 1;
        }
        
        .gold-number {
            color: var(--gold-text);
            font-weight: bold;
            font-size: 1.8rem;
            font-family: 'Courier Prime', monospace;
            display: block;
            margin-top: 5px;
        }

        .location-text {
            font-family: 'Playfair Display', serif;
            font-size: 0.95rem;
            color: #333;
            line-height: 1.4;
        }

        /* Dresscode & Palette */
        .dresscode-text {
            font-family: 'Courier Prime', monospace;
            font-size: 1rem;
            color: #333;
            margin-bottom: 15px;
        }

        .palette-row {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .color-dot {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: inline-block;
        }

        .rsvp-text {
            font-family: 'Courier Prime', monospace;
            font-size: 1.1rem;
            letter-spacing: 1px;
            color: #333;
            font-weight: 600;
        }

        /* --- STYLE FORM (GI·ªÆ NGUY√äN) --- */
        .form-card {
            background: var(--card-bg); max-width: 500px; margin: 0 auto;
            padding: 35px; border-radius: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        .form-group { margin-bottom: 20px; text-align: left; }
        .form-group label { display: block; font-weight: 600; margin-bottom: 5px; color: var(--palette-navy); }
        .form-group .subtitle { font-size: 0.8rem; color: var(--text-sub); margin-bottom: 8px; font-style: italic; }
        
        .input-field {
            width: 100%; padding: 12px; border: 1.5px solid #eee; border-radius: 10px;
            box-sizing: border-box; font-family: inherit; font-size: 0.95rem; transition: 0.3s;
        }
        .input-field:focus { border-color: var(--palette-beige); outline: none; }

        .checkbox-group { display: grid; grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)); gap: 10px; margin-top: 10px; }
        .checkbox-item { display: flex; align-items: center; gap: 5px; font-size: 0.85rem; cursor: pointer; }

        .btn-submit {
            width: 100%; background: var(--palette-navy); color: white; border: none;
            padding: 15px; border-radius: 10px; font-weight: 600; cursor: pointer; transition: 0.3s;
        }
        .btn-submit:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(30, 44, 72, 0.2); }

        .thank-you-box { text-align: center; padding: 20px 10px; display: none; }

        /* --- ADMIN SECTION --- */
        .admin-panel {
            max-width: 1000px; margin: 80px auto 20px auto; border-top: 2px dashed #ccc; padding-top: 20px; text-align: center;
        }
        .btn-export {
            background-color: #10b981; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; margin: 5px;
        }

        /* --- GALLERY --- */
        .gallery { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; }
        .photo-card { background: var(--card-bg); border-radius: 12px; overflow: hidden; border: 1px solid rgba(0,0,0,0.05); }
        .photo-card img { width: 100%; height: 200px; object-fit: cover; }
        .photo-info { padding: 15px; text-align: center; font-weight: 600; }
    </style>
</head>
<body>

    <nav class="taskbar">
        <div class="brand-section">
            <div class="logo-circle">üéì</div>
            <div class="title-group">
                <h1 style="margin:0; font-size:1.2rem;">MinhKhoi's Commencement</h1>
                <p style="margin:0; font-size:0.85rem; color:var(--text-sub);">H√†nh tr√¨nh 1000 ng√†y t·∫°i ƒê√¥n</p>
            </div>
        </div>
        <div class="nav-links">
            <div class="nav-item active" onclick="showTab('tab-intro', this)">L·ªùi t·ª±a</div> 
            <div class="nav-item" onclick="showTab('tab-invitation', this)">Thi·ªáp m·ªùi</div>
            <div class="nav-item" onclick="showTab('tab-gallery', this)">H√¨nh ·∫£nh</div>
            <div class="nav-item" onclick="showTab('tab-guestbook', this)">L∆∞u b√∫t</div>
        </div>
    </nav>

    <div class="content-section active" id="tab-intro">
        <div style="background: var(--card-bg); border-left: 4px solid var(--palette-navy); padding: 35px 40px; border-radius: 0 20px 20px 0; box-shadow: 0 4px 15px rgba(30,44,72,0.05);">
            <h2 style="color:var(--palette-navy); margin-top:0; font-family: 'Playfair Display', serif; font-style: italic;">Tri √¢n nh·ªØng m·∫£nh gh√©p thanh xu√¢n...</h2>
            <p style="font-size: 1.1rem; color: #334155; text-align: justify;">
                "Thanh xu√¢n c·ªßa Minh Kh√¥i kh√¥ng ch·ªâ l√† nh·ªØng trang v·ªü t·∫°i ƒê√¥n, m√† c√≤n l√† m·ªôt b·ª©c tranh r·ª±c r·ª° ƒë∆∞·ª£c d·ªát n√™n t·ª´ s·ª± hi·ªán di·ªán c·ªßa t·∫•t c·∫£ m·ªçi ng∆∞·ªùi. <br><br>
                Kh√¥i mu·ªën g·ª≠i l·ªùi <strong>bi·∫øt ∆°n v√† tri √¢n s√¢u s·∫Øc nh·∫•t</strong> ƒë·∫øn gia ƒë√¨nh, th·∫ßy c√¥ v√† nh·ªØng ng∆∞·ªùi b·∫°n ƒë√£ t·ª´ng xu·∫•t hi·ªán, t·ª´ng ƒë·ªìng h√†nh, ho·∫∑c d√π ch·ªâ l∆∞·ªõt qua trong h√†nh tr√¨nh 1000 ng√†y v·ª´a qua. M·ªói n·ª• c∆∞·ªùi, m·ªói l·ªùi ƒë·ªông vi√™n v√† c·∫£ nh·ªØng th·ª≠ th√°ch m√† ch√∫ng ta c√πng ƒëi qua ƒë√£ nh√†o n·∫∑n n√™n phi√™n b·∫£n Minh Kh√¥i c·ªßa ng√†y h√¥m nay. <br><br>
                C·∫£m ∆°n m·ªçi ng∆∞·ªùi ƒë√£ l√† m·ªôt ph·∫ßn kh√¥ng th·ªÉ thi·∫øu trong nƒÉm th√°ng r·ª±c r·ª° nh·∫•t c·ªßa tu·ªïi tr·∫ª. Hy v·ªçng ch·∫∑ng ƒë∆∞·ªùng ph√≠a tr∆∞·ªõc, ch√∫ng ta v·∫´n s·∫Ω gi·ªØ m√£i nh·ªØng k√Ω ·ª©c ƒë·∫πp ƒë·∫Ω n√†y trong tim."
            </p>
            <p style="text-align: right; font-style: italic; color: var(--palette-navy); font-weight: 600;">‚Äî Tr√¢n tr·ªçng, Minh Kh√¥i</p>
        </div>
    </div>

    <div class="content-section" id="tab-invitation">
        <div class="invitation-card">
            
            <div class="curved-text-container">
                <svg viewBox="0 0 500 150" width="100%" height="100%">
                    <path id="curve" d="M 75, 120 A 200, 200 0 0,1 425, 120" fill="transparent"/>
                    <text class="curved-text" width="500">
                        <textPath xlink:href="#curve" startOffset="50%" text-anchor="middle">
                            The tassel was worth the hassle
                        </textPath>
                    </text>
                </svg>
            </div>

            <div class="grad-cap">
                <svg class="grad-cap-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M22 10L12 5L2 10L12 15L22 10Z" fill="#2D2D2D" stroke="#2D2D2D" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M6 12V17C6 17.5 8.686 19 12 19C15.314 19 18 17.5 18 17V12" fill="#2D2D2D" stroke="#2D2D2D" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M22 10V16C22 16 22 17 20 17" stroke="#D4AF37" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/> <circle cx="20" cy="17" r="1.5" fill="#D4AF37"/>
                </svg>
            </div>

            <div class="intro-text">Please join us in celebrating</div>
            
            <h1 class="script-name">Minh Khoi's</h1>
            
            <div class="main-event-title">GRADUATION</div>
            <div class="sub-event-title">PHOTOSHOOT</div>

            <div class="details-container">
                <div class="detail-col">
                    <span class="gold-label">FEB</span>
                    <span class="gold-number">1</span>
                </div>
                <div class="detail-col center">
                    <div class="location-text">
                        Le Quy Don<br>
                        High School for the Gifted<br>
                        2-3 Nguyen Tat Thanh Str<br>
                        South Nha Trang, Khanh Hoa
                    </div>
                </div>
                <div class="detail-col">
                    <span class="gold-label">9:30</span>
                    <span class="gold-number">AM</span>
                </div>
            </div>

            <div class="dresscode-text">Dress code: semi formal</div>
            
            <div class="palette-row">
                <span class="color-dot" style="background-color: var(--palette-beige);"></span>
                <span class="color-dot" style="background-color: var(--palette-black);"></span>
                <span class="color-dot" style="background-color: var(--palette-white); border: 1px solid #eee;"></span>
                <span class="color-dot" style="background-color: var(--palette-navy);"></span>
                <span class="color-dot" style="background-color: var(--palette-pink);"></span>
                <span class="color-dot" style="background-color: var(--palette-grey);"></span>
                <span class="color-dot" style="background-color: var(--palette-peri);"></span>
            </div>

            <div class="rsvp-text">RSVP +84 833 204 240</div>
        </div>

        <div class="form-card">
            <div id="rsvp-form-container">
                <h3 style="text-align: center; margin-bottom: 25px;">X√°c nh·∫≠n tham gia</h3>
                <form id="rsvp-form" onsubmit="submitRSVP(event)">
                    <div class="form-group">
                        <label>H·ªç v√† t√™n ng∆∞·ªùi tham gia</label>
                        <input type="text" id="rsvp-name" class="input-field" placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n..." required>
                    </div>
                    <div class="form-group">
                        <label>Th√¥ng tin li√™n l·∫°c</label>
                        <p class="subtitle">S·ªë ƒëi·ªán tho·∫°i c·ªßa b·∫°n</p>
                        <input type="tel" id="rsvp-phone" class="input-field" placeholder="090..." required>
                    </div>
                    <div class="form-group">
                        <label>Th·ªùi gian c√≥ th·ªÉ tham d·ª±</label>
                        <div class="checkbox-group">
                            <label class="checkbox-item"><input type="checkbox" name="time" value="8:30AM"> 8:30AM</label>
                            <label class="checkbox-item"><input type="checkbox" name="time" value="9:00AM"> 9:00AM</label>
                            <label class="checkbox-item"><input type="checkbox" name="time" value="9:30AM"> 9:30AM</label>
                            <label class="checkbox-item"><input type="checkbox" name="time" value="10:00AM"> 10:00AM</label>
                            <label class="checkbox-item"><input type="checkbox" name="time" value="11:15AM"> 11:15AM</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>B·∫°n c√≥ l∆∞u √Ω g√¨ khi tham d·ª± kh√¥ng?</label>
                        <textarea id="rsvp-note" class="input-field" rows="3" placeholder="V√≠ d·ª•: L∆∞u √Ω v·ªÅ ƒÉn u·ªëng, di chuy·ªÉn ho·∫∑c h·ªó tr·ª£ kh√°c..."></textarea>
                    </div>
                    <button type="submit" class="btn-submit">X√°c nh·∫≠n g·ª≠i</button>
                </form>
            </div>
            <div id="rsvp-thank-you" class="thank-you-box">
                <div style="font-size: 40px; margin-bottom: 15px;">‚úâÔ∏è</div>
                <h3>C·∫£m ∆°n b·∫°n ƒë√£ x√°c nh·∫≠n tham d·ª±!</h3>
                <p>Minh Kh√¥i r·∫•t mong ch·ªù ƒë∆∞·ª£c g·∫∑p l·∫°i b·∫°n ·ªü bu·ªïi ch·ª•p h√¨nh k·ª∑ y·∫øu s·∫Øp t·ªõi. <br><br> H·∫πn g·∫∑p l·∫°i b·∫°n v·ªõi nh·ªØng n·ª• c∆∞·ªùi r·∫°ng r·ª° nh·∫•t!</p>
            </div>
        </div>
    </div>

    <div class="content-section" id="tab-gallery">
        <div class="gallery">
            <div class="photo-card"><img src="https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=400"><div class="photo-info">L·ªÖ t·ªët nghi·ªáp.jpg</div></div>
            <div class="photo-card"><img src="https://images.unsplash.com/photo-1529156069898-49953e39b3ac?w=400"><div class="photo-info">B·∫°n b√® th√¢n thi·∫øt.png</div></div>
        </div>
    </div>

    <div class="content-section" id="tab-guestbook">
        <div class="form-card">
            <div id="guestbook-form-container">
                <h3 style="text-align: center; margin-bottom: 25px;">G·ª≠i l·ªùi nh·∫Øn k·ª∑ ni·ªám</h3>
                <form id="gb-form" onsubmit="submitGuestbook(event)">
                    <div class="form-group">
                        <label>H·ªç v√† t√™n ng∆∞·ªùi vi·∫øt</label>
                        <input type="text" id="gb-name" class="input-field" placeholder="T√™n c·ªßa b·∫°n l√†..." required>
                    </div>
                    <div class="form-group">
                        <label>Th√¥ng tin li√™n l·∫°c</label>
                        <p class="subtitle">Link social media, sƒët, email...</p>
                        <input type="text" id="gb-contact" class="input-field" placeholder="ƒê·ªÉ ch√∫ng m√¨nh gi·ªØ li√™n l·∫°c nh√©!">
                    </div>
                    <div class="form-group">
                        <label>Th√¥ng ƒëi·ªáp g·ª≠i ƒë·∫øn Minh Kh√¥i ^^</label>
                        <textarea id="gb-msg" class="input-field" rows="5" placeholder="Vi·∫øt nh·ªØng l·ªùi nh·∫Øn nh·ªß c·ªßa b·∫°n t·∫°i ƒë√¢y..." required></textarea>
                    </div>
                    <button type="submit" class="btn-submit">G·ª≠i l·ªùi nh·∫Øn</button>
                </form>
            </div>
            <div id="guestbook-thank-you" class="thank-you-box">
                <div style="font-size: 40px; margin-bottom: 15px;">‚ú®</div>
                <h3>C·∫£m ∆°n b·∫°n ƒë√£ nh·∫Øn g·ª≠i ƒë·∫øn Minh Kh√¥i!</h3>
                <p>Nh·ªØng l·ªùi nh·∫Øn c·ªßa b·∫°n l√† m√≥n qu√† v√¥ gi√° ƒë·ªëi v·ªõi m√¨nh. <br><br> M·∫øn ch√∫c b·∫°n lu√¥n b√¨nh an, h·∫°nh ph√∫c tr√™n ch·∫∑ng ƒë∆∞·ªùng ph√≠a tr∆∞·ªõc!</p>
            </div>
        </div>
    </div>

    <div class="admin-panel">
        <p style="color: var(--text-sub); font-size: 0.8rem;">D√†nh cho Ban t·ªï ch·ª©c: Tr√≠ch xu·∫•t d·ªØ li·ªáu kh√°ch m·ªùi</p>
        <button class="btn-export" onclick="exportToCSV('rsvp')">T·∫£i CSV X√°c nh·∫≠n (RSVP)</button>
        <button class="btn-export" onclick="exportToCSV('guestbook')">T·∫£i CSV L∆∞u b√∫t</button>
    </div>

    <script>
        // M·∫£ng l∆∞u tr·ªØ d·ªØ li·ªáu t·∫°m th·ªùi
        let rsvpData = [];
        let guestbookData = [];

        function showTab(tabId, element) {
            document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            element.classList.add('active');
        }

        function submitRSVP(e) {
            e.preventDefault();
            const selectedTimes = Array.from(document.querySelectorAll('input[name="time"]:checked')).map(cb => cb.value).join("; ");
            
            // L∆∞u d·ªØ li·ªáu v√†o m·∫£ng
            rsvpData.push({
                Name: document.getElementById('rsvp-name').value,
                Phone: document.getElementById('rsvp-phone').value,
                Times: selectedTimes,
                Note: document.getElementById('rsvp-note').value
            });

            document.getElementById('rsvp-form-container').style.display = 'none';
            document.getElementById('rsvp-thank-you').style.display = 'block';
        }

        function submitGuestbook(e) {
            e.preventDefault();
            
            // L∆∞u d·ªØ li·ªáu v√†o m·∫£ng
            guestbookData.push({
                Name: document.getElementById('gb-name').value,
                Contact: document.getElementById('gb-contact').value,
                Message: document.getElementById('gb-msg').value.replace(/\n/g, " ") 
            });

            document.getElementById('guestbook-form-container').style.display = 'none';
            document.getElementById('guestbook-thank-you').style.display = 'block';
        }

        // H√ÄM XU·∫§T CSV
        function exportToCSV(type) {
            let data = [];
            let filename = "";
            let headers = [];

            if (type === 'rsvp') {
                data = rsvpData;
                filename = "Danh_sach_RSVP_MinhKhoi.csv";
                headers = ["Ho va Ten", "So Dien Thoai", "Khung Gio", "Luu Y"];
            } else {
                data = guestbookData;
                filename = "Luu_but_MinhKhoi.csv";
                headers = ["Ho va Ten", "Thong Tin Lien Lac", "Loi Nhan"];
            }

            if (data.length === 0) {
                alert("Ch∆∞a c√≥ d·ªØ li·ªáu n√†o ƒë·ªÉ xu·∫•t t·ªáp!");
                return;
            }

            // Chuy·ªÉn m·∫£ng th√†nh ƒë·ªãnh d·∫°ng CSV (c√≥ BOM ƒë·ªÉ ƒë·ªçc ƒë∆∞·ª£c ti·∫øng Vi·ªát trong Excel)
            let csvContent = "\uFEFF"; 
            csvContent += headers.join(",") + "\n";
            
            data.forEach(item => {
                let row = Object.values(item).map(val => `"${val}"`).join(",");
                csvContent += row + "\n";
            });

            // T·∫°o link t·∫£i xu·ªëng
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement("a");
            const url = URL.createObjectURL(blob);
            link.setAttribute("href", url);
            link.setAttribute("download", filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html>